!function(a){a(document).ready(function(){CKAN.Dgu.setupPublisherUserAutocomplete(a("input.autocomplete-publisher-user")),CKAN.Dgu.setupPackageAutocomplete(a("input.autocomplete-dataset"))})}(jQuery);var CKAN=CKAN||{};CKAN.Dgu=function(a,b){return b.stub=function(){},b.setupPublisherUserAutocomplete=function(b){b.autocomplete({minLength:2,source:function(b,c){var d="/api/2/util/user/autocomplete?q="+b.term;a.getJSON(d,function(b){a.each(b,function(a,b){var c="";b.name,b.fullname&&(c+=b.fullname),c+=" ["+b.name+"]",b.label=c,b.value=b.name}),c(b)})},select:function(b,c){var d=a(this);d.val("");var e=a(".added-users"),f=d.attr("name"),g=/^(\S+)__(\d+)__(\S+)$/,h=f.match(g),i=h[1]+"__"+(parseInt(h[2])+1)+"__"+h[3];d.attr("name",i),d.attr("id",i);var j=a("input:radio[name=add-user-capacity]:checked").val();return e.after('<input type="hidden" name="'+f+'" value="'+c.item.value+'">'+'<input type="hidden" name="'+f.replace("__name","__capacity")+'" value="'+j+'">'+"<dd>"+c.item.label+"</dd>"),!1}})},b.setupPackageAutocomplete=function(b){b.autocomplete({minLength:0,source:function(b,c){var d="/api/util/dataset/autocomplete?q="+b.term;a.ajax({url:d,success:function(b){var d=[],e=b.split("\n");a.each(e,function(a,b){var c=b.split("|"),e={label:c[0],value:c[1]};d.push(e)}),c(d)}})},select:function(b,c){var d=a(this);d.val("");var e=a(".added-users"),f=d.attr("name"),g=/^(\S+)__(\d+)__(\S+)$/,h=f.match(g),i=h[1]+"__"+(parseInt(h[2])+1)+"__"+h[3];d.attr("name",i),d.attr("id",i),e.after('<input type="hidden" name="'+f+'" value="'+c.item.value+'">'+"<dd>"+c.item.label+"</dd>")}})},b}(jQuery,CKAN.Dgu||{});